<?xml version="1.0" encoding="utf-8"?>
<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
        <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
        <PlatformTarget>x64</PlatformTarget>
        <ProjectGuid>{00000000-0000-0000-0000-000000000000}</ProjectGuid>
        <OutputType>Library</OutputType>
        <AppDesignerFolder>Properties</AppDesignerFolder>
        <RootNamespace>$safeprojectname$</RootNamespace>
        <AssemblyName>$safeprojectname$</AssemblyName>
        <TargetFramework>net47</TargetFramework>
        <FileAlignment>512</FileAlignment>
        <Deterministic>true</Deterministic>
        <TargetFrameworkProfile />
        <LangVersion>latest</LangVersion>
        <NuGetPackageImportStamp>
        </NuGetPackageImportStamp>
        <Configurations>Debug;Release;R2020;R2021;R2022;R2023;R2024;R2025;R2026</Configurations>
    </PropertyGroup>
    
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2020|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2020\</OutputPath>
        <DefineConstants>DEBUG;R2020</DefineConstants>
        <TargetFramework>net47</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2020</RevitVersion>
        <LangVersion>latest</LangVersion>
        <ErrorReport>prompt</ErrorReport>
        <WarningLevel>4</WarningLevel>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2020\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    </PropertyGroup>
    
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2021|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2021\</OutputPath>
        <DefineConstants>DEBUG;R2021</DefineConstants>
        <TargetFramework>net48</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2021</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2021\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    </PropertyGroup>
    
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2022|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2022\</OutputPath>
        <DefineConstants>DEBUG;R2022</DefineConstants>
        <TargetFramework>net48</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2022</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2022\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    </PropertyGroup>
    
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2023|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2023\</OutputPath>
        <DefineConstants>DEBUG;R2023</DefineConstants>
        <TargetFramework>net48</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2023</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2023\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    </PropertyGroup>

    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2024|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2024\</OutputPath>
        <DefineConstants>DEBUG;R2024</DefineConstants>
        <TargetFramework>net48</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2024</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2024\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
    </PropertyGroup>

    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2025|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2025\</OutputPath>
        <DefineConstants>DEBUG;R2025</DefineConstants>
        <TargetFramework>net8.0-windows</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2025</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2025\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
        <UseWPF>true</UseWPF>
    </PropertyGroup>
    
    <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'R2026|AnyCPU' ">
        <DebugSymbols>true</DebugSymbols>
        <DebugType>full</DebugType>
        <Optimize>false</Optimize>
        <OutputPath>bin\R2026\</OutputPath>
        <DefineConstants>DEBUG;R2026</DefineConstants>
        <TargetFramework>net8.0-windows</TargetFramework>
        <AssemblyName>$(AssemblyName)</AssemblyName>
        <RevitVersion>2025</RevitVersion>
        <WarningLevel>4</WarningLevel>
        <LangVersion>latest</LangVersion>
        <StartAction>Program</StartAction>
        <StartProgram>$(ProgramW6432)\Autodesk\Revit 2026\Revit.exe</StartProgram>
        <EnableDefaultEmbeddedResourseItems>false</EnableDefaultEmbeddedResourseItems>
        <EnableDefaultCompileItems>false</EnableDefaultCompileItems>
        <UseWPF>true</UseWPF>
    </PropertyGroup>

    <Choose>
        <When Condition=" '$(Configuration)'=='R2020' ">
            <ItemGroup>
                <Reference Include="System" />
                <Reference Include="System.Configuration" />
                <Reference Include="System.Core" />
                <Reference Include="PresentationFramework" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2020.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2021' ">
            <ItemGroup>
                <Reference Include="System" />
                <Reference Include="System.Configuration" />
                <Reference Include="System.Core" />
                <Reference Include="PresentationFramework" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2021.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2022' ">
            <ItemGroup>
                <Reference Include="System" />
                <Reference Include="System.Configuration" />
                <Reference Include="System.Core" />
                <Reference Include="PresentationFramework" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2022.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2023' ">
            <ItemGroup>
                <Reference Include="System" />
                <Reference Include="System.Configuration" />
                <Reference Include="System.Core" />
                <Reference Include="PresentationFramework" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2023.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2024' ">
            <ItemGroup>
                <Reference Include="System" />
                <Reference Include="System.Configuration" />
                <Reference Include="System.Core" />
                <Reference Include="PresentationFramework" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2024.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2025' ">
            <ItemGroup>
                <FrameworkReference Include="Microsoft.WindowsDesktop.App" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2025.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
        <When Condition=" '$(Configuration)'=='R2026' ">
            <ItemGroup>
                <FrameworkReference Include="Microsoft.WindowsDesktop.App" />
                <PackageReference Include="Revit_All_Main_Versions_API_x64" Version="2026.0.0" IncludeAssets="build; compile" PrivateAssets="All" />
            </ItemGroup>
        </When>
    </Choose>
    <ItemGroup>
        <Compile Include="App.cs" />
        <Compile Include="Command.cs" />
        <Compile Include="Properties\AssemblyInfo.cs" />
        <Content Include="$projectname$.addin">
            <CopyToOutputDirectory>Always</CopyToOutputDirectory>
        </Content>
    </ItemGroup>
    <Target Name="AfterClean">
        <Delete Files="$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)\$projectname$.addin" />
        <Delete Files="$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)\$projectname$.dll" />
    </Target>
    <Target Name="PostBuild" AfterTargets="PostBuildEvent">
        <Exec Command="if exist &quot;$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)&quot; xcopy /Y /i &quot;$(TargetDir)$(TargetName).dll&quot; &quot;$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)\$(ProjectName)\&quot;" />
        <Exec Command="if exist &quot;$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)&quot; xcopy /Y /i &quot;$(TargetDir)$(TargetName).addin&quot; &quot;$(AppData)\Autodesk\REVIT\Addins\$(RevitVersion)&quot;" />
    </Target>
</Project>